<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2017-02-08 23:53:14 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="/swc-releases/2017.02/sql-novice-survey">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-swc.ico" />
    
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Databases and SQL: Sorting and Removing Duplicates</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/swc-icon-blue.svg" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

	
        
        <li><a href="../setup/">Setup</a></li>
        <li><a href="../reference/">Reference</a></li>
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-select/">Selecting Data</a></li>
            
            <li><a href="../02-sort-dup/">Sorting and Removing Duplicates</a></li>
            
            <li><a href="../03-filter/">Filtering</a></li>
            
            <li><a href="../04-calc/">Calculating New Values</a></li>
            
            <li><a href="../05-null/">Missing Data</a></li>
            
            <li><a href="../06-agg/">Aggregation</a></li>
            
            <li><a href="../07-join/">Combining Data</a></li>
            
            <li><a href="../08-hygiene/">Data Hygiene</a></li>
            
            <li><a href="../09-create/">Creating and Modifying Data</a></li>
            
            <li><a href="../10-prog/">Programming with Databases - Python</a></li>
            
            <li><a href="../11-prog-R/">Programming with Databases - R</a></li>
            
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../license/">License</a></li>
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../01-select/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
    <h3 class="maintitle"><a href="../">Databases and SQL</a></h3>
    <h1 class="maintitle">Sorting and Removing Duplicates</h1>
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../03-filter/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 10 min
      <br/>
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can I sort a query’s results?</p>
</li>
	
	<li><p>How can I remove duplicate values from a query’s results?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Write queries that display results in a particular order.</p>
</li>
	
	<li><p>Write queries that eliminate duplicate values from data.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>In beginning our examination of the Antarctic data, we want to know:</p>

<ul>
  <li>what kind of quantity measurements were taken at each site;</li>
  <li>which scientists took measurements on the expedition;</li>
  <li>the sites where each scientist took measurements</li>
</ul>

<p>To determine which measurements were taken at each site,
we can examine the <code class="highlighter-rouge">Survey</code> table.
Data is often redundant,
so queries often return redundant information.
For example,
if we select the quantities that have been measured
from the <code class="highlighter-rouge">Survey</code> table,
we get this:</p>

<div class="sql highlighter-rouge"><pre class="highlight"><code>SELECT quant FROM Survey;
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>quant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>temp</td>
    </tr>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>temp</td>
    </tr>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>temp</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>temp</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>rad</td>
    </tr>
  </tbody>
</table>

<p>This result makes it difficult to see all of the different types of
<code class="highlighter-rouge">quant</code> in the Survey table.  We can eliminate the redundant output to
make the result more readable by adding the <code class="highlighter-rouge">DISTINCT</code> keyword to our
query:</p>

<div class="sql highlighter-rouge"><pre class="highlight"><code>SELECT DISTINCT quant FROM Survey;
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>quant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>rad</td>
    </tr>
    <tr>
      <td>sal</td>
    </tr>
    <tr>
      <td>temp</td>
    </tr>
  </tbody>
</table>

<p>If we want to determine which sites have which quant measurement,
we can use the <code class="highlighter-rouge">DISTINCT</code> keyword on multiple columns.
If we select more than one column,
the distinct <em>pairs</em> of values are returned:</p>

<div class="sql highlighter-rouge"><pre class="highlight"><code>SELECT DISTINCT taken, quant FROM Survey;
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>taken</th>
      <th>quant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>619</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>619</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>622</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>622</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>734</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>734</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>734</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>735</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>735</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>735</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>751</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>751</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>751</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>752</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>752</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>752</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>837</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>837</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>844</td>
      <td>rad</td>
    </tr>
  </tbody>
</table>

<p>Notice in both cases that duplicates are removed
even if the rows they come from didn’t appear to be adjacent in the database table.</p>

<p>Our next task is to identify the scientists on the expedition by looking at the <code class="highlighter-rouge">Person</code> table.
As we mentioned earlier,
database records are not stored in any particular order.
This means that query results aren’t necessarily sorted,
and even if they are,
we often want to sort them in a different way,
e.g., by their identifier instead of by their personal name.
We can do this in SQL by adding an <code class="highlighter-rouge">ORDER BY</code> clause to our query:</p>

<div class="sql highlighter-rouge"><pre class="highlight"><code>SELECT * FROM Person ORDER BY id;
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>id</th>
      <th>personal</th>
      <th>family</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>danfort</td>
      <td>Frank</td>
      <td>Danforth</td>
    </tr>
    <tr>
      <td>dyer</td>
      <td>William</td>
      <td>Dyer</td>
    </tr>
    <tr>
      <td>lake</td>
      <td>Anderson</td>
      <td>Lake</td>
    </tr>
    <tr>
      <td>pb</td>
      <td>Frank</td>
      <td>Pabodie</td>
    </tr>
    <tr>
      <td>roe</td>
      <td>Valentina</td>
      <td>Roerich</td>
    </tr>
  </tbody>
</table>

<p>By default,
results are sorted in ascending order
(i.e.,
from least to greatest).
We can sort in the opposite order using <code class="highlighter-rouge">DESC</code> (for “descending”):</p>

<div class="sql highlighter-rouge"><pre class="highlight"><code>SELECT * FROM person ORDER BY id DESC;
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>id</th>
      <th>personal</th>
      <th>family</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>roe</td>
      <td>Valentina</td>
      <td>Roerich</td>
    </tr>
    <tr>
      <td>pb</td>
      <td>Frank</td>
      <td>Pabodie</td>
    </tr>
    <tr>
      <td>lake</td>
      <td>Anderson</td>
      <td>Lake</td>
    </tr>
    <tr>
      <td>dyer</td>
      <td>William</td>
      <td>Dyer</td>
    </tr>
    <tr>
      <td>danfort</td>
      <td>Frank</td>
      <td>Danforth</td>
    </tr>
  </tbody>
</table>

<p>(And if we want to make it clear that we’re sorting in ascending order,
we can use <code class="highlighter-rouge">ASC</code> instead of <code class="highlighter-rouge">DESC</code>.)</p>

<p>In order to look at which scientist measured quantities at each site,
we can look again at the <code class="highlighter-rouge">Survey</code> table.
We can also sort on several fields at once.
For example,
this query sorts results first in ascending order by <code class="highlighter-rouge">taken</code>,
and then in descending order by <code class="highlighter-rouge">person</code>
within each group of equal <code class="highlighter-rouge">taken</code> values:</p>

<div class="sql highlighter-rouge"><pre class="highlight"><code>SELECT taken, person, quant FROM Survey ORDER BY taken ASC, person DESC;
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>taken</th>
      <th>person</th>
      <th>quant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>619</td>
      <td>dyer</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>619</td>
      <td>dyer</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>622</td>
      <td>dyer</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>622</td>
      <td>dyer</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>734</td>
      <td>pb</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>734</td>
      <td>pb</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>734</td>
      <td>lake</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>735</td>
      <td>pb</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>735</td>
      <td>-null-</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>735</td>
      <td>-null-</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>751</td>
      <td>pb</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>751</td>
      <td>pb</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>751</td>
      <td>lake</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>752</td>
      <td>roe</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>752</td>
      <td>lake</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>752</td>
      <td>lake</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>752</td>
      <td>lake</td>
      <td>temp</td>
    </tr>
    <tr>
      <td>837</td>
      <td>roe</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>837</td>
      <td>lake</td>
      <td>rad</td>
    </tr>
    <tr>
      <td>837</td>
      <td>lake</td>
      <td>sal</td>
    </tr>
    <tr>
      <td>844</td>
      <td>roe</td>
      <td>rad</td>
    </tr>
  </tbody>
</table>

<p>This query gives us a good idea of which scientist was at which site,
and what measurements they performed while they were there.</p>

<p>Looking at the table, it seems like some scientists specialized in
certain kinds of measurements.  We can examine which scientists
performed which measurements by selecting the appropriate columns and
removing duplicates.</p>

<div class="sql highlighter-rouge"><pre class="highlight"><code>SELECT DISTINCT quant, person FROM Survey ORDER BY quant ASC;
</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>quant</th>
      <th>person</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>rad</td>
      <td>dyer</td>
    </tr>
    <tr>
      <td>rad</td>
      <td>pb</td>
    </tr>
    <tr>
      <td>rad</td>
      <td>lake</td>
    </tr>
    <tr>
      <td>rad</td>
      <td>roe</td>
    </tr>
    <tr>
      <td>sal</td>
      <td>dyer</td>
    </tr>
    <tr>
      <td>sal</td>
      <td>lake</td>
    </tr>
    <tr>
      <td>sal</td>
      <td>-null-</td>
    </tr>
    <tr>
      <td>sal</td>
      <td>roe</td>
    </tr>
    <tr>
      <td>temp</td>
      <td>pb</td>
    </tr>
    <tr>
      <td>temp</td>
      <td>-null-</td>
    </tr>
    <tr>
      <td>temp</td>
      <td>lake</td>
    </tr>
  </tbody>
</table>

<blockquote class="challenge">
  <h2 id="finding-distinct-dates">Finding Distinct Dates</h2>

  <p>Write a query that selects distinct dates from the <code class="highlighter-rouge">Visited</code> table.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="displaying-full-names">Displaying Full Names</h2>

  <p>Write a query that displays the full names of the scientists in the <code class="highlighter-rouge">Person</code> table,
ordered by family name.</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>The records in a database table are not intrinsically ordered: if we want to display them in some order, we must specify that explicitly with ORDER BY.</p>
</li>
    
    <li><p>The values in a database are not guaranteed to be unique: if we want to eliminate duplicates, we must specify that explicitly as well using DISTINCT.</p>
</li>
    
  </ul>
</blockquote>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../01-select/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../03-filter/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      <footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016
	<a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="mailto:lessons@software-carpentry.org">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    <script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
